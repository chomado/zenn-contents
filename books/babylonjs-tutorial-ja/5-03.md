---
title: "5-03: æœ¨ã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ (Sprite Trees)"
---

ã“ã®ãƒšãƒ¼ã‚¸ã®åŸæ–‡ï¼š https://doc.babylonjs.com/start/chap5/trees

# ğŸŒ² 5-03: æœ¨ã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ (Sprite Trees)

ã“ã‚Œã‹ã‚‰ã€2 ã¤ã®æ£® (500 æœ¬ã®æœ¨ãŒç”Ÿãˆã¦ã‚‹æ£®) ã‚’æ¤ãˆã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/56866e588d78-20220501.png)

åˆè¨ˆ 1000 æœ¬ã®æœ¨ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‚ã‘ã§ã™ãŒã€ã‚‚ã—å…¨ã¦ã®æœ¨ã« 3D ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ãŸã‚‰å‡¦ç†ãŒé‡ããªã‚Šã¾ã™ã­ã€‚

ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚’é€Ÿãä¿ã¤ãŸã‚ã«ã€ä»Šå› æœ¨ã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ (sprite) ã‚’ä½¿ã†ã“ã¨ã«ã—ã¾ã™ã€‚
ã¤ã­ã«ã‚«ãƒ¡ãƒ©ã®ã»ã†ã‚’å‘ã„ã¦ã„ã‚‹ã€2D ç”»åƒã§ã™ã€‚

ä»Šå›ã¯ã“ã®ç”»åƒã‚’ä½¿ã„ã¾ã™

![](https://doc.babylonjs.com/_next/image?url=%2Fimg%2Fgetstarted%2Fpalmtree.png&w=2048&q=75)

## ğŸ–¼ SpriteManager ã‚¯ãƒ©ã‚¹

æœ¨ã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ (sprite) ã‚’æ“ä½œã™ã‚‹ãŸã‚ã«ã€sprite manager ã‚’è¨­å®šã—ã¾ã™

```js
const spriteManagerTrees = new BABYLON
  .SpriteManager(
    "treesManager", 
    "æœ¨ã®ç”»åƒã®URL", 
    2000, 
    {width: 512, height: 1024}, 
    scene
  );
```

### SpriteManager ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¿…é ˆå¼•æ•°ã®è§£èª¬

SpriteManager ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€
ãƒãƒãƒ¼ã‚¸ãƒ£ã®åå‰ã€ç”»åƒã®URLã€ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®æœ€å¤§æ•°ã€ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®å¹…ã¨é«˜ã•ã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆç”»åƒã®å¹…ã¨é«˜ã•ï¼‰ã§ã™ã€‚

```ts
new SpriteManager(
  name: string,   // ã“ã® SpriteManager ã®åå‰ã‚’æ±ºã‚ã‚‹ã€‚ä¾‹ "treesManager"
  imgUrl: string, // sprite sheet ã® url
  capacity: number, // ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®æœ€å¤§æ•°ã€‚ä¾‹ 2000
  cellSize: any,  // cell ã®ã‚µã‚¤ã‚ºã€‚ä»Šå›ã®å ´åˆã¯ç”»åƒã®å¹…ã¨é«˜ã•ã«ãªã‚‹ã€‚ä¾‹ {width: 512, height: 1024}
  scene: Scene,   // ãƒ›ã‚¹ãƒˆã™ã‚‹ scene ã‚’æŒ‡å®š
)
```

å‚è€ƒï¼‰SpriteManager ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
https://doc.babylonjs.com/typedoc/classes/babylon.spritemanager

# ğŸ” ã‚³ãƒ¼ãƒ‰ã®è§£èª¬

![](https://storage.googleapis.com/zenn-user-upload/135837a49f3d-20220501.gif)

ã•ã£ããæœ¨ã‚’å¤§é‡ã«æ¤ãˆã¦æ£®ã‚’ãµãŸã¤ä½œã‚Šã¾ã—ã‚‡ã†ã€‚
ãã‚Œãã‚Œã®æ£®ã« 500 æœ¬ãšã¤æ¤ãˆã¾ã™ã€‚

```js
// æ£® 1
for (let i = 0; i < 500; i++) {
    const tree = new BABYLON.Sprite("tree", spriteManagerTrees);
    // æœ¨ã‚’æ¤ãˆã‚‹åº§æ¨™æŒ‡å®š
    tree.position.x = Math.random() * (-30);
    tree.position.z = Math.random() * 20 + 8;
    tree.position.y = 0.5;
}

// æ£® 2
for (let i = 0; i < 500; i++) {
    const tree = new BABYLON.Sprite("tree", spriteManagerTrees);
    // æœ¨ã‚’æ¤ãˆã‚‹åº§æ¨™æŒ‡å®š
    tree.position.x = Math.random() * (25) + 7;
    tree.position.z = Math.random() * -35  + 8;
    tree.position.y = 0.5;
}
```

â†“ å‹•ä½œã®æ§˜å­

https://playground.babylonjs.com/#KBS9I5#89

https://twitter.com/chomado/status/1520719692994084864

## ğŸ‘€ Sprite ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è§£èª¬

```ts
new Sprite(
  name: string,           // ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®åå‰ã‚’æŒ‡å®š
  manager: ISpriteManager // SpriteManager ã‚’æŒ‡å®š
)
```

å‚è€ƒï¼‰Class Sprite ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
https://doc.babylonjs.com/typedoc/classes/babylon.sprite

# ğŸ›¸ ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

![](https://storage.googleapis.com/zenn-user-upload/254d603596ea-20220501.gif)

è¤‡æ•°æšã®ç”»åƒã‚’ä½¿ã£ã¦ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

![](https://doc.babylonjs.com/_next/image?url=%2Fimg%2Fgetstarted%2Fufo.png&w=2048&q=75)

åŒã˜ã‚µã‚¤ã‚ºã® ã‚»ãƒ« ãƒ•ãƒ¬ãƒ¼ãƒ  (cell frame (å°ã•ãªåŒºç”»)) ãŒç¸¦ 4 æ¨ª 5 ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

ä»Šå›ã¯ã€SpriteManager ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«æ¸¡ã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã® cellSize ã«ã€ã²ã¨ã¤ã® cell ã®ã‚µã‚¤ã‚º (å¹…ã¨é«˜ã•) ã‚’æ¸¡ã—ã¾ã™ã€‚
ï¼ˆå‰å› (ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç„¡ã—) ã§ã¯æœ¨ã®ç”»åƒ 1 æšã®ã‚µã‚¤ã‚ºã§ã—ãŸã­ï¼‰

```js
const spriteManagerUFO = new BABYLON
  .SpriteManager(
    "UFOManager",
    "UFOç”»åƒã®URL", 
    1, 
    {width: 128, height: 76}
  );
```

ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€
ãƒ«ãƒ¼ãƒ—ã™ã‚‹ï¼ˆtrueï¼‰ã‹ã©ã†ã‹ã«é–¢ä¿‚ãªãã€
ä½¿ç”¨ã™ã‚‹æœ€åˆã¨æœ€å¾Œã®ã‚»ãƒ«ã¨ã‚»ãƒ«ãƒ•ãƒ¬ãƒ¼ãƒ é–“ã®æ™‚é–“ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦
è¨­å®šã•ã‚Œã¾ã™ã€‚

```js
const ufo = new BABYLON.Sprite("ufo", spriteManagerUFO);
ufo.playAnimation(0, 16, true, 125);
```

â†“ å‹•ä½œãƒ‡ãƒ¢
https://playground.babylonjs.com/#KBS9I5#90

# â˜ æ¬¡ã¯

ã“ã“ã¾ã§ãŒç¬¬ 5 ç« ã§ã—ãŸã€‚
æ¬¡ã®ç¬¬ 6 ç« ã§ã¯ã€å‹•ã„ã¦ã„ã‚‹å™´æ°´ã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†
